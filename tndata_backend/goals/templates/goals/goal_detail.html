{% extends "goals/base.html" %}
{% load goal_tags %}
{% load goal_filters %}
{% load util_tags %}
{% load util_filters %}

{% block content %}
  <ul class="breadcrumbs">
    <li><a href="{% url 'goals:index' %}">Home</a></li>
    <li><a href="{% url 'goals:goal-list' %}">Goals</a></li>
    <li class="current">{{ goal }}</li>
  </ul>

  <div class="row">
    <div class="large-6 small-12 columns">
      <h1>{{ goal }} {% object_controls goal "goals" %}</h1>
      <dl>
      <dt>State</dt><dd>{{ goal.state|label }}</dd>
      <dt>Description</dt><dd>{{ goal.description|markdown }}</dt>
      <dt>Icon</dt><dd class="gray">
        {% with icon=goal.get_absolute_icon %}
        {% if icon %}
          <a href="{{ icon }}" target="_blank">
          <img src="{{ icon }}" alt="{{ goal }} icon" />
          </a>
        {% else %}
          <em>No icon available</em>
        {% endif %}
        {% endwith %}
      </dd>
      </dl>
      {% modified goal %}
      {% if perms.goals.publish_goal %}{% publish_deny_form goal %}{% endif %}

    </div>
    <div class="large-6 small-12 columns">
      {% if goal.notes %}
        <h2 class="subheader">Notes</h2>
        <div class="panel">{{ goal.notes|markdown }}</div>
      {% endif %}
      <h2 class="subheader">Categories</h2>
      <p><em>{{goal}}</em> is listed in the following Categories:</p>
      <ul>
      {% for cat in goal.categories.all %}
        <li>
          {{cat.state|label}}
          <a href="{{cat.get_absolute_url }}">{{ cat }}</a>
        </li>
      {% endfor %}
      </ul>

      <h2 class="subheader">Behavior Content</h2>
      <p><em>{{goal }}</em> contains the following behaviors and actions:</p>
      <ul>
      {% for bs in goal.behavior_set.all %}
        <li>{{bs.state|label}} <a href="{{ bs.get_absolute_url }}">{{bs}}</a>
          <ul>
            {% for ba in bs.action_set.all %}
              <li>
                {{ ba.state|label }}
                <a href="{{ ba.get_absolute_url }}">{{ ba }}</a>
              </li>
            {% endfor %}
          </ul>
        </li>
      {% empty %}
        <li><em>There are currently no Behaviors listed in this Goal</em></li>
      {% endfor %}
      </ul>

    </div>
  </div> {# end .row #}
{% endblock %}
