{% extends "goals/base.html" %}
{% load goal_tags %}
{% load goal_filters %}
{% load util_tags %}
{% load util_filters %}

{% block content %}
  <ul class="breadcrumbs">
    <li><a href="{% url 'goals:index' %}">Home</a></li>
    <li><a href="{% url 'goals:category-list' %}">Categories</a></li>
    <li class="current">{{ category }}</li>
  </ul>

  <div class="row">
    <div class="large-6 small-12 columns">
      <h1>{{ category }} {% object_controls category "goals" %}</h1>
      <dl>
        <dt>State</dt><dd>{{ category.state|label }}</dd>
        <dt>Icon</dt><dd>
          {% with icon=category.get_absolute_icon %}
          {% if icon %}
            <a href="{{ icon }}" target="_blank">
            <img src="{{ icon }}" alt="{{ category }} icon" />
            </a>
          {% else %}
            <em>No icon available</em>
          {% endif %}
          {% endwith %}
        </dd>
        <dt>Hero Image</dt><dd>
          {% with image=category.get_absolute_image %}
          {% if image %}
            <a href="{{ image }}" target="_blank">
            <img src="{{ image }}" alt="{{ category }} image" />
            </a>
          {% else %}
            <em>No image available</em>
          {% endif %}
          {% endwith %}
        </dd>
        <dt>Order</dt><dd>{{ category.order }}</dd>
        <dt>Description</dt><dd>{{ category.description|markdown }}</dd>
        <dt>Color</dt><dd>
          <span style="display:inline-block;width:18px;height:18px;background-color:{{category.color}};">
          </span>
          {{ category.color }}
         </dd>
      </dl>
      {% modified category %}
      {% if perms.goals.publish_category %}{% publish_deny_form category %}{% endif %}

    </div>
    <div class="large-6 small-12 columns">
      {% if category.notes %}
        <h2 class="subheader">Notes</h2>
        <div class="panel">{{ category.notes|markdown }}</div>
      {% endif %}
      <h2 class="subheader">Content</h2>
      <p><strong>{{ category }}</strong>
        contains the following goals, sequences, and behaviors:</p>
      <ul>
      {% for goal in category.goals %}
        <li>{{ goal }}
          <ul>
          {% for bs in goal.behavior_set.all %}
            <li>{{bs}}
              <ul>
                {% for ba in bs.action_set.all %}
                  <li>{{ ba }}</li>
                {% endfor %}
              </ul>
            </li>
          {% endfor %}
          </ul>
        </li>
      {% endfor %}
      </ul>
    </div>
  </div>
{% endblock %}
