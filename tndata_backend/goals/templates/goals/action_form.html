{% extends "goals/base.html" %}
{% load static from staticfiles %}


{% block head %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'timepicker/jquery.timepicker.css' %}" />
  {# See bodyjs block for the timepicker js and config #}
{% endblock %}


{% block content %}
<h1>{% if object %}Action: {{object.name}}{% else %}Create Action{% endif %}</h1>

<div class="row">
  <div class="large-6 small-12 columns">

    <p>An <strong>Action</strong> is the Behavior-change activity in which
    users will engange. Actions belong to one or more
    <strong>Interests</strong>.</p>
    <p>The structure of our data looks something like the following:</p>
    <pre class="panel">
  Category
    - Interest Group
      - Interest 1
        - Action 1
        - Action 2
      - Interest 2
        - Action 3
        - Action 4
    </pre>
    <p>Complete the form below to add or update an Action.</p>

    <form action="{% if object %}{{ object.get_update_url }}{% else %}{% url 'goals:action-create' %}{% endif %}" method="post" enctype="multipart/form-data">{% csrf_token %}
    {{ form.as_p }}
    <hr/>
    {% if object %}
      <button type="submit">Update Action</button>
    {% else %}
      <button type="submit">Create Action</button>
    {% endif %}
    </form>
  </div>
  <div class="large-6 small-12 columns">
    <table>
      <caption>Existing Actions</caption>
      <thead>
        <tr><th>Order</th><th>Name</th><th>Summary</th><th>Interests</th></tr>
      </thead>
      <tbody>
      {% for action in actions %}
        <tr>
          <td>{{ action.order }}</td>
          <td><a href="{{action.get_absolute_url }}">{{ action.name }}</a></td>
          <td>{{ action.summary|truncatewords:10 }}</td>
          <td>
            {% for action in action.actionerests.all %}
              {{action}}{% if not forloop.last %}<br/>{% endif %}
            {% empty %}
              <em>None</em>
            {% endfor %}
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}


{% block bodyjs %}
  {{ block.super }}
  <script src="{% static 'timepicker/jquery.timepicker.min.js' %}"></script>
  <script>
  $(document).ready(function() {
    $('.timepicker').timepicker({
      timeFormat: "G:i",
      minTime: '5:00'
    });
  });
  </script>
{% endblock %}
