{% extends "goals/base.html" %}
{% load goal_filters %}
{% load goal_tags %}

{% block title %}Notifications{% endblock %}

{% block breadcrumbs %}
    <li class="current">Notification</li>
{% endblock %}

{% block content %}
  <div class="row">
    <div class="large-12 small-12 columns">
      <h1>Notifications</h2>

      <dl class="sub-nav">
        <dt>Filter:</dt>
        <dd{% if state_filter == "all" %} class="active"{% endif %}>
          <a href="?state=all">All</a></dd>
        <dd{% if state_filter == "draft" %} class="active"{% endif %}>
          <a href="?state=draft">Draft</a></dd>
        <dd{% if state_filter == "published" %} class="active"{% endif %}>
          <a href="?state=published">Published</a></dd>
        <dd class="{% if state_filter == "pending-review" %}active {% endif %}
          hide-for-small-only"><a href="?state=pending-review">Pending</a></dd>
        <dd class="{% if state_filter == "declined" %}active {% endif %}
          hide-for-small-only"><a href="?state=declined">Declined</a></dd>
      </dl>

      <table class="object-list">
      <thead>
      <tr>
        <th>
          {% if user|is_editor %}
            <i class="fa fa-cog"></i>
          {% endif %}
          State
        </th>
        <th>Order</th>
        <th>Title</th>
        <th>Notification</th>
        <th>Trigger Time</th>
        <th>Trigger Date</th>
        <th>Trigger Repeat</th>
        <th>Behavior</th>
        <th>Icon</th>
        <th>Selected By</th>
      </tr>
      </thead>
      <tbody>
      {% for action in actions %}
        <tr>
          <td>
            {% if user|is_editor %}
              {% publish_deny_form action "dropdown" %}
            {% else %}
              {{ action|label }}
            {% endif %}
          </td>
          <td>{{ action.sequence_order }}</td>
          <td>
            <a href="{{ action.get_absolute_url }}">
              {{ action }}</a>
          </td>
          <td>{{ action.notification_text }}</td>
          {% with trigger=action.default_trigger %}
            <td>{{ trigger.time|default:"-"}}</td>
            <td>{{ trigger.trigger_date|default:"-" }}</td>
            <td>{{ trigger.recurrences_as_text|default:"-" }}</td>
          {% endwith %}
          <td>{{ action.behavior }}</td>
          <td class="gray">
            {% with icon=action.get_absolute_icon %}
              {% if icon %}
                <img src="{{ icon }}" alt="{{ action }} icon" class="list-icon" />
              {% endif %}
            {% endwith %}
          </td>
          <td>{{ action.useraction__count }}</td>
        </tr>
      {% endfor %}
      </tbody>
      </table>
    </div>
  </div> {# end .row #}
  <hr/>
{% endblock %}

