{% extends "goals/base.html" %}
{% load goal_tags %}
{% load goal_filters %}
{% load crispy_forms_tags %}


{% block title %}Category Form{% endblock %}


{% block head %}
  {{ block.super }}
  {{ form.media }}
{% endblock %}


{% block breadcrumbs %}
  <li><a href="{% url 'goals:category-list' %}">Categories</a></li>
  <li class="current">
    {% if object %}{{ category }}{% else %}New Category {% endif %}
  </li>
{% endblock %}


{% block content %}
<h1>{% if object %}Update Category: {{object}}{% else %}Create Category{% endif %}</h1>
<p>A <strong>Category</strong> is the top-level organizational unit for
Goals &amp; their Actions, and is the first thing a user will see in the app.</p>

<form
  data-persist="garlic"
  action="{% if object %}{{ object.get_update_url }}{% else %}{% url 'goals:category-create' %}{% endif %}"
  method="post"
  enctype="multipart/form-data">{% csrf_token %}

  {% crispy form %}
  <div class="row">
    <div class="large-12 small-12 columns">
    {% form_buttons object "Category" %}
    </div>
  </div>
</form>

<hr/>

<div class="row">
  <div class="large-6 small-12 columns">
    <p>The structure of our data looks something like the following. Categories
    may contain multiple goals. Goals may contain multiple Behaviors, and
    Behaviors contains Notifications.</p>
    <pre class="panel">
Category
  - Goal 1
  -- Behavior 1
  --- Notification 1
  --- Notification 2
  - Goal 2
  -- Behavior 2
  --- Notification 3
  --- Notification 4
    </pre>
  </div>
  <div class="large-6 small-12 columns">
    <table>
      <caption>Existing Categories</caption>
      <thead>
        <tr><th>Order</th><th>Name</th><th>State</th><th>Created</th></tr>
      </thead>
      <tbody>
      {% for cat in categories %}
        <tr>
          <td>{{ cat.order }}</td>
          <td><a href="{{ cat.get_absolute_url }}">{{ cat }}</a></td>
          <td>
            {{ cat|label }}
            {% if cat.is_packaged %}
              <span class="label info">Package</span>
            {% endif %}
          </td>
          <td>
            {% if cat.created_by %}{{ cat.created_by.get_short_name }} on<br/>{% endif %}
            {{ cat.created_on|date:"M j, Y" }}
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
