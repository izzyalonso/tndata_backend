{% extends "goals/base.html" %}
{% load goal_filters %}
{% load goal_tags %}

{% block title %}Categories{% endblock %}


{% block breadcrumbs %}
    <li class="current">Categories</li>
{% endblock %}

{% block content %}
  <div class="row">
    <div class="large-12 small-12 columns">
      <h1>Categories</h2>
      <table class="object-list">
      <thead>
      <tr>
        <th>
          {% if user|is_editor %}
            <i class="fa fa-cog"></i>
          {% endif %}
          State
        </th>
        <th>Order</th>
        <th>Icon</th>
        <th>Colors</th>
        <th>Title</th>
        <th>Child Content</th>
        <th>Selected By</th>
      </tr>
      </thead>
      <tbody>
      {% for category in categories %}
        {% with category_url=category.get_absolute_url %}
        <tr>
          <td>
            {% if user|is_editor %}
              {% publish_deny_form category "dropdown" %}
            {% else %}
              {{ category|label }}
            {% endif %}
          </td>
          <td>{{ category.order }}</td>
          <td>
            {% with icon=category.get_absolute_icon %}
              {% if icon %}
                <div class="gray centered">
                  <a href="{{ category_url }}">
                    <img src="{{ icon }}" class="list-icon" alt="{{ category }} icon"/>
                  </a>
                </div>
              {% else %}
                <em>no icon</em>
              {% endif %}
            {% endwith %}
          </td>
          <td>
            <div class="color"
                 style="height:25px;width:25px;background-color:{{ category.color}};">
            </div>
            {% if category.secondary_color %}
            <div class="color"
                 style="height:25px;width:25px;background-color:{{ category.secondary_color}};">
            </div>
            {% endif %}
          </td>
          <td>
              <a href="{{ category_url }}">{{ category }}</a>
              {% if category.is_packaged %}
                <span class="label info">Package</span>
              {% endif %}
          </td>
          <td>
            <ul class="accordion" data-accordion>
              <li class="accordion-navigation">
                <a href="#category-{{category.id}}-goals">Goals</a>
                <div id="category-{{category.id}}-goals" class="content">
                {% for c in category.goals %}
                  <a href="{{ c.get_absolute_url }}">
                    <span class="label secondary radius">{{ c }}</span>
                  </a>
                {% endfor %}
                </div>
              </li>
              <li class="accordion-navigation">
                <a href="#category-{{category.id}}-behaviors">Behaviors</a>
                <div id="category-{{category.id}}-behaviors" class="content">
                {% for b in category.behaviors %}
                  <a href="{{ b.get_absolute_url }}">
                    <span class="label secondary radius">{{ b }}</span>
                  </a>
                {% endfor %}
                </div>
              </li>
            </ul>
          </td>
          <td>{{ category.usercategory__count }}</td>
        </tr>
        {% endwith %}
      {% endfor %}
      </tbody>
      </table>
    </div>
  </div> {# end .row #}
  <hr/>
{% endblock %}

